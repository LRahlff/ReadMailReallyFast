stages:
    - prebuild
    - build
    - testing
    - deploy

prebuild:
    stage: prebuild
    script:
        - gcc --version
        - g++ --version
    tags:
        - rmrf
        - rmrfcode

build:bsd:
    stage: build
    dependencies:
        - prebuild
    script:
        - gmake
    artifacts:
        paths:
            - bin
    tags:
        - rmrf
        - rmrfcode
        - freebsd

build:deb:
    stage: build
    dependencies:
        - prebuild
    script:
        - make
        - dpkg-buildpackage -b -us -uc
    artifacts:
        paths:
            - bin
            - ../rmrf*.deb
            - ../rmrf*.ddeb
            - ../rmrf*.changes
            - ../rmrf*.buildinfo
    tags:
        - rmrf
        - rmrfcode
        - debian

test:bsd:
    stage: testing
    dependencies:
        - build:bsd
    script:
        - echo Successfully tested.

test:deb:
    stage: testing
    dependencies:
        - build:deb
    script:
        - echo Successfully tested.
